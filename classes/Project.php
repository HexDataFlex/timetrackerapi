<?php 

/* 
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚îÇ ‚Å°‚Å£‚Å¢‚Å£‚Äã‚Äå‚Äå‚Äåùï°ùï£ùï†ùïõùïñùïîùï•_ùïóùïüùï§.ùï°ùïôùï°‚Äã‚Å°                                                                                          ‚îÇ
  ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
  ‚îÇ A set of function to manipulate with projects. DÕüoÕücÕüuÕümÕüeÕünÕütÕüaÕütÕüiÕüoÕün bÕüeÕülÕüoÕüw.                                     ‚îÇ
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
 */

 /**
  * File for manipulating with projects.
  * 
  * This file contains a class that manipulates with projects.
  * 
  * PHP version 7.4.27
  * 
  * LICENSE: This source file is subject to version 3 of the GNU GPL license
  * that is available through the world-wide-web at the following URI:
  * http://www.gnu.org/licenses/gpl-3.0.html.
  * 
  * @category   Database
  * @author     Adam Ondrejƒç√°k <adam.ondrejcak@gmail.com>
  * @license    http://www.gnu.org/licenses/gpl-3.0.html  GNU GPL v3
  * @version    prerelease-1.0
  * @since      File available since alpha-2.1.1
  */

  /* -------------------------------------------------------------------------- */
  /*                                  Includes                                  */
  /* -------------------------------------------------------------------------- */
  include_once 'config.php';
  
/* -------------------------------------------------------------------------- */

/**
 * Creates a project
 * 
 * @param integer $userId  ID of the user
 * @param string  $name    Comment
 * 
 * @author Adam Ondrejƒç√°k <adam.ondrejcak@gmail.com>
 */
function createProject($userId, $name) {
    DB::query("INSERT INTO projects (name, user_id) VALUES (:name, :userId)", array(':name'=>$name, ':userId'=>$userId));
}

/**
 * Edits a project
 * 
 * @param integer $projectId  ID of the project
 * @param string  $name   Comment
 * 
 * @author Adam Ondrejƒç√°k <adam.ondrejcak@gmail.com>
 */
function editProject($projectId, $name) {
    DB::query("UPDATE projects SET name=:value WHERE id=:projectId", array(':value'=>$name, ':projectId'=>$projectId));
}

/**
 * Deletes a project
 * 
 * @param integer $projectId  ID of the project
 * 
 * @author Adam Ondrejƒç√°k <adam.ondrejcak@gmail.com>
 */
function deleteProject($projectId) {
    DB::query("DELETE FROM projects WHERE id=:tagId", array(':tagId'=>$projectId));
}

/**
 * Gets id of the project
 * 
 * @param integer $userId  ID of the user
 * @param string  $name    Comment
 * 
 * @return integer
 * 
 * @author Adam Ondrejƒç√°k <adam.ondrejcak@gmail.com>
 */
function getProject($userId, $name) {
    $id = DB::count("SELECT * FROM projects WHERE name=:name AND user_id=:userId", array(':name'=>$name, ':userId'=>$userId)) ? DB::query("SELECT * FROM projects WHERE name=:name AND user_id=:userId", array(':name'=>$name, ':userId'=>$userId))[0]['id'] : null;
    return $id;
}

/**
 * Gets the list of users projects
 * 
 * @param integer $userId  ID of the user
 * 
 * @return array
 * 
 * @author Adam Ondrejƒç√°k <adam.ondrejcak@gmail.com>
 */
function listProjects($userId) {
    if(DB::count("SELECT * FROM projects WHERE user_id=:userId", array(':userId'=>$userId)) >= 1) {
        return DB::query("SELECT * FROM projects WHERE user_id=:userId", array(':userId'=>$userId));
    } else {
        echo json_encode(array("error"=>"No projects found for this user"));
        return null;
    }
}